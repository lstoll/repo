#!/bin/bash

set -e

DFDIR="$(cd $(dirname $0)/.. && pwd)"

# Link everything in Link
for f in $(ls -A $DFDIR/symlink/); do
    if [ -e ~/$f ]; then
	if [ -L ~/$f ]; then
	    if ! readlink -n ~/$f | grep -q $DFDIR; then
		echo "$f is already a link, but to the wrong location"
		exit 1
	    else
		echo "$f is already linked"
	    fi
	else
	    echo "$f already exists as a non sym-linked file or directory"
	    exit 1
	fi
    else
	echo "Linking $f"
	ln -s $DFDIR/symlink/$f ~/$f
    fi
done
